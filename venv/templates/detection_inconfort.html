<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Détéction inconfort</title>
  <link rel="icon" href="../static/house-solid.svg" type="image/x-icon">

  {% include 'link.html' %}


</head>

<body class="bg-gray-900 ">
  <style>
    .hidden {
      display: none;
    }
  </style>
  {% include 'navbar.html' %}
  <div id="particles-js" style="height: 185vh;width: 100vw;z-index: -50; position: fixed; top: 0;">


  </div>
  <!-- <div class="bg-black/20 backdrop-blur-sm" style="height: 185vh;width: 100vw;z-index: -40; position: fixed; top: 0;">

  </div> -->

  <div class="justify-center flex mb-5 mt-5 fade-in">


    <div class="input-group flex-nowrap  mr-2 " style="width: 30vw;">
      <span class="input-group-text bg-gray-600 text-white border-none" id="addon-wrapping"><i
          class="bi bi-building"></i></span>
      <select class="form-select bg-gray-600 text-white border-none" name="" id="salle">
        <option value="D251">D251</option>
        <option value="D351">D351</option>
        <option value="D360">D360</option>



      </select>

    </div>



  </div>
  <div class="flex justify-center mb-4 mt-4 fade-in">
    <div class=" text-green-500 ml-5 mt-2 text-2xl" >
      <i class="bi bi-check-circle-fill"></i>
      Confort      / Oui
    </div>
    <div class=" text-orange-500 ml-5 mt-2 text-2xl" >
      <i class="bi bi-x-circle-fill"></i> Inconfort      
    </div>
    <div class=" text-red-500 ml-5 mt-2 text-2xl" >
      <i class="bi bi-x-circle-fill"></i> Danger   / Non
    </div>
  </div>

  <div class="flex justify-center items-center fade-in">

    <div class="grid grid-cols-2 gap-14 pr-5 " style="height: 70vh; overflow: auto;">

      <div id="container" class="bg-gray-800 rounded " style="height: fit-content; width: fit-content;">
        <h1 class="text-white p-3 flex justify-center" style="width: 25vw;">Fenêtre ouverte</h1>

        <div class="flex justify-center  items-center"
          style="width: 25vw; height: 20vh; font-size: 100px;">
          <i class="bi bi-x-circle-fill text-red-500" id="fenetreIcon"></i>
        </div>
      </div>

      <div id="container" class="bg-gray-800 rounded " style="height: fit-content; width: fit-content;">
        <h1 class="text-white p-3 flex justify-center" style="width: 25vw;">CO2 </h1>
        <div class="flex justify-center   items-center"
          style="width: 25vw; height: 20vh; font-size: 100px;">
          <i class="bi bi-check-circle-fill text-green-500" id="Co2Icon"></i>
        </div>
      </div>


      <div id="container_bruit" class="bg-gray-800 rounded " style="height: fit-content; width: fit-content;">
        <h1 class="text-white p-3 flex justify-center" style="width: 25vw;">Bruit</h1>

        <div class="flex justify-center   items-center"
          style="width: 25vw; height: 20vh; font-size: 100px;">
          <i class="bi bi-check-circle-fill text-green-500" id="bruitIcon"></i>
        </div>
      </div>
      <div id="container_humidite" class="bg-gray-800 rounded " style="height: fit-content; width: fit-content;">
        <h1 class="text-white p-3 flex justify-center" style="width: 25vw;">Mouvement</h1>

        <div class="flex justify-center   items-center"
          style="width: 25vw; height: 20vh; font-size: 100px;">
          <i class="bi bi-check-circle-fill text-green-500" id="mouvementIcon"></i>
        </div>
      </div>
      <div id="presenceD351"  class="bg-gray-800 rounded hidden" style="height: fit-content; width: fit-content;">
        <h1 class="text-white p-3 flex justify-center" style="width: 25vw;">Presence salle des personnels</h1>

        <div class="flex justify-center   items-center"
          style="width: 25vw; height: 20vh; font-size: 100px;">
          <i class="bi bi-check-circle-fill text-green-500" id="presenceIcon"></i>
        </div>
      </div>
    </div>
    

  </div>


  {% include 'link_js.html' %}







</body>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


  <script>
    const icons = ["bi bi-check-circle-fill text-green-500","bi bi-x-circle-fill text-orange-500"
            ,"bi bi-x-circle-fill text-red-500"]
    function updateComfort() {
      axios.get('/get_data/'+$('#salle').val(), { params: { "t": new Date().getTime() } })
          .then(response => {
              const data = response.data;
              let comfortPpm = data.comfortPpm;
              let comfortDba = data.comfortDba;
              let movementHere = data.comfortHere;
              let comfortwindow = data.comfortwindow;
              let presenceD351 = data.presenceD351;
              let Co2Icon =  document.getElementById('Co2Icon');
              let bruitIcon =  document.getElementById('bruitIcon');
              let mouvementIcon =  document.getElementById('mouvementIcon');
              let fenetreIcon =  document.getElementById('fenetreIcon');
              let presenceIcon =  document.getElementById('presenceIcon');
              let divPresenceD351 = document.getElementById('presenceD351');

              if (comfortPpm >= 0) {
                Co2Icon.className = '';
                Co2Icon.className = icons[comfortPpm];
              }

              if (comfortDba >= 0) {
                bruitIcon.className = '';
                bruitIcon.className = icons[comfortDba];
              }

              if (movementHere >= 0) {
                mouvementIcon.className = '';
                mouvementIcon.className = icons[movementHere];
              }

              if (comfortwindow >= 0) {
                fenetreIcon.className = '';
                fenetreIcon.className = icons[comfortwindow];
              }

              if ($('#salle').val() == "D351") {
                divPresenceD351.classList.remove("hidden");
                if (presenceD351 >= 0) {
                  presenceIcon.className = '';
                  presenceIcon.className = icons[presenceD351];
                }
              } else {
                divPresenceD351.classList.add("hidden");
              }
              
          })
          .catch(error => {
              console.error('There was an error!', error);
          });
    }
    updateComfort()

    $('#salle').change(() => {
      updateComfort()

    })

    // setInterval(updateComfort, 300000);
    setInterval(updateComfort, 60000);
    
    $(document).keydown(function(e) {
      if (e.key === "k") {
        if ($("#fenetreIcon").hasClass("bi bi-check-circle-fill text-green-500")) {
          document.getElementById('fenetreIcon').className = icons[2]; 
        } else {
          document.getElementById('fenetreIcon').className = icons[0]; 
        }
      }

      if (e.key === "j") {
        if ($("#mouvementIcon").hasClass("bi bi-check-circle-fill text-green-500")) {
          document.getElementById('mouvementIcon').className = icons[2]; 
        } else {
          document.getElementById('mouvementIcon').className = icons[0]; 
        }
      }
    });
    // setInterval(updateComfort, 300);
  </script>


</html>